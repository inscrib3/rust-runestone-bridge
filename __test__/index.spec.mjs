import test from "ava";

import { encipher, decipher } from "../index.js";

const transactionHex =
  "02000000000101cdc726a5b950fa583ac679a588f21468e54ecdea1ba3dda3eb97f0f32c31982b000000000006000000031027000000000000225120671548bc8c35814a13351f4b2306178dcd55fdad1b6a02873374a8610b466b4310270000000000002251201d889ba3c96937285525abe3bdcff2fac3da56e56040e2573971eb00083993e50000000000000000276a5d24020304efdfafbed590d5d2b9c0d298d3ccbd1a03a0928501052406904e0ae807085a16010340bdbcbaee258ec0227cd943d3dab60e8cbb6ee71c4fa775878c26001471774854a3f4d705936a906a3a33942280faa88ed5d483ec263dfd816d0f636de20ae81f5d2028d79edb75bb181984405ae81621de4f22580495b0ff5eda47c7c6826f5bef5cac0063036f7264010118746578742f706c61696e3b636861727365743d7574662d38010200010d0eefefcb578554a539a0143365f63400033c330a6821c128d79edb75bb181984405ae81621de4f22580495b0ff5eda47c7c6826f5bef5c00000000";

const scriptPubKeyHex =
  "6a5d24020304efdfafbed590d5d2b9c0d298d3ccbd1a03a0928501052406904e0ae807085a1601";

test("generate encipher and decipher correctly", (t) => {
  const transaction = decipher(transactionHex);
  const script = encipher(transaction);
  t.is(scriptPubKeyHex, script.toString("hex"));
});
